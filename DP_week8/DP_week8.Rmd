---
title: "week8_DP"
author: "CÃ¡tia Reis"
date: "`r Sys.Date()`"
output: 
  github_document:
   toc: true
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r message=F, warning=F}
library(dplyr)
library(knitr)
library(ggplot2)
```
## The coordination dataset 

We will be looking at the same dataset that we used in [week 6](https://github.com/kaktos2/Practicals/blob/b0359cddcbe321f9a0707f52a1e50e1533a206e6/DP_week6/DP_week6.md). 

```{r}
coordination<-read.table(file="coordination.csv", header=TRUE, sep=";",dec=",") 
coordination %>% kable()
```

### The variables

- Explanatory variables (as named in the dataset) : "roles" and "feedback_percentage" 
- Response variables : performance, i.e. "average_flying_time"& "average_distance"

### Correlation

I picked "average_flying_time" for our response variable in the formula we are going to use but we could also be doing this with the "average_distance" variable. 

```{r}
cor.test(coordination$feedback_percentage,coordination$average_flying_time)
```
There is a positive correlation between the two and the p-value is below 0.05 which tells us it is significant. However,correlation does not imply causation. 


### General Linear Model

Let's use the `lm()` function to study the relationship between the variables. 
```{r}
general<-lm(coordination$feedback_percentage~coordination$average_flying_time)
summary(general)
```


### Plot 

Let's make this visual. 

```{r}
ggplot(coordination,aes(feedback_percentage,average_flying_time,label=rownames(coordination),color=roles)) +
    geom_point() + labs(y ="Average flying time (in seconds)" , x = "Feedback percentage") + geom_text(hjust = -0.3)+geom_smooth(method = "lm", se = TRUE,color="black")  
```

With the summary of the model and this plot, we see that there is a significant impact of feedback percentage on the performance of the planes. 


